# Project Description
This repository contains a general Bayesian computational framework for the concurrent estimation of time-varying and time-invariant parameters in nonlinear stochastic dynamical systsems.

The code used to generate the results presented in the paper [A Bayesian model calibration framework for stochastic compartmental models with both time-varying and time-invariant parameters](https://www.sciencedirect.com/science/article/pii/S2468042724000563) can be found in the `/framework/Examples` directory.

## Table of Contents
- [Installation](#installation)
- [Usage](#usage)
- [License](#license)


# Installation
The code is tested on Mint 18.2, Ubuntu 22.04, and various machines in the Digital Reseach Alliance of Canada consortium (currently for the machine 'Graham'). README files and scripts relevant to the compilation of the framework on these systems can be found at:  
`/framework/readme_mint182`  
`/framework/readme_ubuntu2204`  
`/framework/readme_graham`  

# Usage

The synthetic data can be generated by running either of the following ipython notebooks:   
`/framework/Examples/GenData_SIR_commandline.ipynb`  
Can be run from the command line, plots will not be displayed, but figures and data are saved in the appropriate subdirectory  

`/framework/Examples/GenData_SIR_viewer.ipynb`  
Can be run in VS Code, Jupyter notebooks, Google Colab etc. plots will be displayed inline, figures and data will also be saved in the appropriate subdirectory.

Existing results can be plotted, and cases can be modified or re-run from the following subdirectories:  
`/framework/Examples/Case00` Section 3.1.1 Synthetic data case 1: random variations  
`/framework/Examples/Case01` Section 3.1.2 Synthetic data case 2: seasonal variations  
`/framework/Examples/Case02` Section 3.1.3 Synthetic data case 3: abrubt lockdown measures  
`/framework/Examples/Case03` Section 3.2 Public health data: Ontario (April 1, 2020 - March 31, 2021)  

Within these directories, the parameter estimation and state estimation results can be plotted by running either of the following ipython notebooks:  
`/framework/Examples/Case0X/PlotPDF0X_commandline.ipynb`  or `/framework/Examples/Case0X/PlotPDF0X_viewer.ipynb`  
`/framework/Examples/Case0X/PlotSE0X_commandline.ipynb`  or `/framework/Examples/Case0X/PlotSE0X_viewer.ipynb`  


State space models can be altered by modifying the file. Existing state spaces can be edited, or new ones may be defined following the template.  
`/framework/Examples/functions.cpp`  

Parameter estimation is performed using:  
`/framework/Examples/case0X.cfg`

The MCMC chans are stored in the directory  
`/framework/Examples/Case0X/chains`

Following the parameter estimation, state estimation is performed using  
`/framework/Examples/case00se.cfg`  
`/framework/Examples/case01se.cfg`  
`/framework/Examples/case02se.cfg`  
`/framework/Examples/case03se.cfg`  

This will by default perform a single instance of state estimation, performed at the MAP estimate of the paramters, you can alternatively run state estimation without performing parameter estimation, by defning an input vector of time-invariant parameters in the .cfg file.

